<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gotovka ‚Äî –ò–ò-—Ä–µ—Ü–µ–ø—Ç—ã</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
      max-width: 700px;
      margin: 20px auto;
      padding: 0 15px;
      background: #fff;
      color: #333;
    }
    h1 { text-align: center; color: #2e8b57; margin-bottom: 25px; }
    .main-menu, .healthy-menu, .search-view {
      text-align: center;
    }
    .btn {
      display: inline-block;
      width: 90%;
      max-width: 300px;
      padding: 14px;
      margin: 10px 0;
      font-size: 16px;
      font-weight: bold;
      color: white;
      background: #8fbc8f; /* —Å–∞–ª–∞—Ç–æ–≤—ã–π */
      border: none;
      border-radius: 8px;
      cursor: pointer;
      text-decoration: none;
    }
    .btn:hover {
      background: #6f9c6f;
    }
    .back-btn {
      background: #556b2f;
      margin-top: 25px;
    }
    .back-btn:hover {
      background: #455a24;
    }
    .recipe {
      background: #f9f9f9;
      padding: 16px;
      margin: 16px 0;
      border-radius: 10px;
      white-space: pre-wrap;
      line-height: 1.5;
    }
    .loading { color: #7f8c8d; text-align: center; font-style: italic; }
    .day { 
      background: #e8f5e9; 
      padding: 12px; 
      margin: 12px 0; 
      border-radius: 8px; 
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>üç≤ Gotovka</h1>

  <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
  <div id="main-menu" class="main-menu">
    <button class="btn" onclick="showSearch('byName')">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é</button>
    <button class="btn" onclick="showSearch('byIngredients')">–ò–∑ —Ç–æ–≥–æ, —á—Ç–æ –µ—Å—Ç—å</button>
    <button class="btn" onclick="showHealthyMenu()">–ó–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ</button>
  </div>

  <!-- –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é -->
  <div id="search-by-name" class="search-view" style="display:none;">
    <input type="text" id="queryName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –±–æ—Ä—â —Å –≥–æ–≤—è–¥–∏–Ω–æ–π" style="width:90%; padding:12px; margin:10px 0; border:1px solid #ccc; border-radius:6px;"/>
    <button class="btn" onclick="searchByName()">–ù–∞–π—Ç–∏ —Ä–µ—Ü–µ–ø—Ç</button>
    <button class="btn back-btn" onclick="showMainMenu()">–í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
    <div id="results"></div>
  </div>

  <!-- –ü–æ–∏—Å–∫ –ø–æ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞–º -->
  <div id="search-by-ingredients" class="search-view" style="display:none;">
    <input type="text" id="queryIngredients" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —è–π—Ü–∞, –ø–æ–º–∏–¥–æ—Ä—ã, –ª—É–∫" style="width:90%; padding:12px; margin:10px 0; border:1px solid #ccc; border-radius:6px;"/>
    <button class="btn" onclick="searchByIngredients()">–ß—Ç–æ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å?</button>
    <button class="btn back-btn" onclick="showMainMenu()">–í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
    <div id="results2"></div>
  </div>

  <!-- –ú–µ–Ω—é –∑–¥–æ—Ä–æ–≤–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è -->
  <div id="healthy-menu" class="healthy-menu" style="display:none;">
    <h2>ü•ó –ó–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ (–ü–Ω‚Äì–ß—Ç)</h2>
    <div class="day">–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫: –û–≤—Å—è–Ω–∫–∞ —Å —è–≥–æ–¥–∞–º–∏ + –∑–µ–ª—ë–Ω—ã–π —á–∞–π</div>
    <div class="day">–í—Ç–æ—Ä–Ω–∏–∫: –°–∞–ª–∞—Ç –∏–∑ –∫–∞–ø—É—Å—Ç—ã –∏ –º–æ—Ä–∫–æ–≤–∏ + –∫—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ –Ω–∞ –ø–∞—Ä—É</div>
    <div class="day">–°—Ä–µ–¥–∞: –¢—É—à—ë–Ω—ã–µ –æ–≤–æ—â–∏ + –≥—Ä–µ—á–∫–∞ + –∫–µ—Ñ–∏—Ä</div>
    <div class="day">–ß–µ—Ç–≤–µ—Ä–≥: –ó–∞–ø–µ—á—ë–Ω–Ω–∞—è —Ä—ã–±–∞ + –±—Ä–æ–∫–∫–æ–ª–∏ + –ª–∏–º–æ–Ω–Ω–∞—è –≤–æ–¥–∞</div>
    <button class="btn back-btn" onclick="showMainMenu()">–í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
  </div>

  <script>
    const API_KEY = "YCPCqM2sdZa-cV8eQjfQgF5MOd8YzoyH1KXeVudY";
    const CATALOG_ID = "b1gk7vrlj4a3eqnv8ugg";

    function showMainMenu() {
      document.getElementById('main-menu').style.display = 'block';
      document.getElementById('search-by-name').style.display = 'none';
      document.getElementById('search-by-ingredients').style.display = 'none';
      document.getElementById('healthy-menu').style.display = 'none';
    }

    function showSearch(mode) {
      document.getElementById('main-menu').style.display = 'none';
      if (mode === 'byName') {
        document.getElementById('search-by-name').style.display = 'block';
        document.getElementById('search-by-ingredients').style.display = 'none';
      } else {
        document.getElementById('search-by-name').style.display = 'none';
        document.getElementById('search-by-ingredients').style.display = 'block';
      }
      document.getElementById('healthy-menu').style.display = 'none';
    }

    function showHealthyMenu() {
      document.getElementById('main-menu').style.display = 'none';
      document.getElementById('search-by-name').style.display = 'none';
      document.getElementById('search-by-ingredients').style.display = 'none';
      document.getElementById('healthy-menu').style.display = 'block';
    }

    async function askYandexGPT(prompt) {
      const response = await fetch('https://llm.api.cloud.yandex.net/foundationModels/v1/completion', {
        method: 'POST',
        headers: {
          'Authorization': `Api-Key ${API_KEY}`,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          modelUri: `gpt://${CATALOG_ID}/yandexgpt/latest`,
          completionOptions: {
            stream: false,
            temperature: 0.6,
            maxTokens: "2000"
          },
          messages: [
            {
              role: "system",
              text: "–¢—ã ‚Äî –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –ø–æ–≤–∞—Ä-—ç–∫—Å–ø–µ—Ä—Ç. –û—Ç–≤–µ—á–∞–π —Å—Ç—Ä–æ–≥–æ –ø–æ –¥–µ–ª—É: —Å–Ω–∞—á–∞–ª–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞, –∑–∞—Ç–µ–º —Å–ø–∏—Å–æ–∫ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ —Å –º–µ—Ä–∞–º–∏, –∑–∞—Ç–µ–º –ø–æ—à–∞–≥–æ–≤—ã–π —Ä–µ—Ü–µ–ø—Ç. –ü–∏—à–∏ —Ç–æ–ª—å–∫–æ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –ë–µ–∑ –ª–∏—à–Ω–µ–≥–æ —Ç–µ–∫—Å—Ç–∞."
            },
            {
              role: "user",
              text: prompt
            }
          ]
        })
      });

      if (!response.ok) throw new Error(`–û—à–∏–±–∫–∞ ${response.status}`);
      const data = await response.json();
      if (!data?.result?.alternatives?.[0]?.message?.text) throw new Error("–ù–µ—Ç –æ—Ç–≤–µ—Ç–∞ –æ—Ç –ò–ò");
      return data.result.alternatives[0].message.text;
    }

    async function searchByName() {
      const input = document.getElementById('queryName').value.trim();
      if (!input) return alert("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞");
      const resDiv = document.getElementById('results');
      resDiv.innerHTML = '<p class="loading">–ò–ò –≥–æ—Ç–æ–≤–∏—Ç —Ä–µ—Ü–µ–ø—Ç... ‚è≥</p>';
      try {
        const ans = await askYandexGPT(`–†–µ—Ü–µ–ø—Ç –±–ª—é–¥–∞: ${input}`);
        resDiv.innerHTML = `<div class="recipe">${ans}</div>`;
      } catch (err) {
        resDiv.innerHTML = `<p style="color:red;">‚ùå ${err.message}</p>`;
      }
    }

    async function searchByIngredients() {
      const input = document.getElementById('queryIngredients').value.trim();
      if (!input) return alert("–í–≤–µ–¥–∏—Ç–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã");
      const resDiv = document.getElementById('results2');
      resDiv.innerHTML = '<p class="loading">–ò–ò –¥—É–º–∞–µ—Ç... ‚è≥</p>';
      try {
        const ans = await askYandexGPT(`–ß—Ç–æ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –∏–∑: ${input}? –î–∞–π –æ–¥–∏–Ω –ø–æ–¥—Ä–æ–±–Ω—ã–π —Ä–µ—Ü–µ–ø—Ç.`);
        resDiv.innerHTML = `<div class="recipe">${ans}</div>`;
      } catch (err) {
        resDiv.innerHTML = `<p style="color:red;">‚ùå ${err.message}</p>`;
      }
    }

    // Enter –¥–ª—è –ø–æ–∏—Å–∫–∞
    document.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        if (document.getElementById('search-by-name').style.display === 'block') {
          searchByName();
        } else if (document.getElementById('search-by-ingredients').style.display === 'block') {
          searchByIngredients();
        }
      }
    });
  </script>
</body>
</html>